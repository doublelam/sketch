{"version":3,"sources":["webpack:///webpack/bootstrap 93aa04b3e56d289025a4","webpack:///./ts/utils/consolelog.ts","webpack:///./ts/components/GetDom.ts","webpack:///./ts/components/getPixelsFromCanvas.ts","webpack:///./ts/components/domOperate.ts","webpack:///./ts/App.ts","webpack:///./ts/components/Events.ts","webpack:///./ts/utils/Worker.ts","webpack:///./ts/components/drawLines.ts","webpack:///./sass/index.sass","webpack:///../node_modules/.4.7.0@font-awesome/scss/font-awesome.scss"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;;;;;;;;AChCA;AACA;AACA;AACA,cAAc,EAAE;AAChB;AACA;AACA,eAAe,EAAE;AACjB;AACA;AACA,kBAAkB,EAAE;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACxBA;AACA;AACA;AACA,2BAA2B,WAAW;AACtC,2BAA2B,WAAW;AACtC;AACA;AACA;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA,iBAAiB,GAAG,EAAE,0BAA0B,oBAAoB,EAAE;AACtE;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA,YAAY;AACZ,wBAAwB,uDAAuD;AAC/E;AACA;AACA,CAAC;AACD;AACA;AACA;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,oBAAoB;AACvD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,6BAA6B,QAAQ,0BAA0B;AACvH;AACA;AACA;AACA,CAAC;AACD;AACA,kCAAkC,yBAAyB;;;;;;;;AC1C3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,MAAM;AACN,kCAAkC,yBAAyB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,EAAE,GAAG,QAAQ,GAAG,MAAM,GAAG,MAAM;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjDA,yC;;;;;;ACAA,yC","file":"js/index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 93aa04b3e56d289025a4","\"use strict\";\nexports.__esModule = true;\nexports.logColors = function (msg, color) {\n    var args = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        args[_i - 2] = arguments[_i];\n    }\n    if (typeof msg !== 'string') {\n        return console.log.apply(console, [msg].concat(args));\n    }\n    return console.log.apply(console, [\"%c\" + msg, \"color: \" + color].concat(args));\n};\nexports.logRed = function (msg) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    return exports.logColors.apply(void 0, [msg, '#CE594B'].concat(args));\n};\nexports.logGreen = function (msg) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    return exports.logColors.apply(void 0, [msg, '#4C9F67'].concat(args));\n};\nexports.logBlue = function (msg) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    return exports.logColors.apply(void 0, [msg, '#588CEE'].concat(args));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/utils/consolelog.ts\n// module id = 0\n// module chunks = 0 1","\"use strict\";\nexports.__esModule = true;\nexports.getEle = function (query) {\n    if (/^#\\w{1}/g.test(query)) {\n        return document.getElementById(query.replace(/^#/g, ''));\n    }\n    if (/^\\.\\w{1}/g.test(query)) {\n        return document.getElementsByClassName(query.replace(/^#/g, ''));\n    }\n    if (/^tag\\:\\w{1}/g) {\n        return document.getElementsByTagName(query.replace(/^tag\\:/g, ''));\n    }\n    return document.querySelectorAll(query);\n};\n// first raw canvas\nexports.canvasRaw = exports.getEle('#canvas-raw');\nexports.rawContxt = exports.canvasRaw.getContext('2d');\n// second redraw canvas\n// export const canvasReDraw: HTMLCanvasElement = <HTMLCanvasElement>getEle('#canvas-redraw');\n// export const redrawContxt: CanvasRenderingContext2D = canvasReDraw.getContext('2d');\n// third final canvas\nexports.canvasFinal = exports.getEle('#canvas-final-draw');\nexports.finalContxt = exports.canvasFinal.getContext('2d');\nexports.fileInput = exports.getEle('#file-input');\nexports.sketchBtn = exports.getEle('#sketch-confirm');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/components/GetDom.ts\n// module id = 1\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\nexports.getPixelsFromCanvas = function (ctx, fromX, fromY) {\n    if (fromX === void 0) { fromX = 0; }\n    if (fromY === void 0) { fromY = 0; }\n    var imgData = ctx.getImageData(fromX, fromY, ctx.canvas.width, ctx.canvas.height);\n    return imgData;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/components/getPixelsFromCanvas.ts\n// module id = 2\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\nvar getPixelsFromCanvas_1 = require(\"./getPixelsFromCanvas\");\nvar Worker_1 = require(\"../utils/Worker\");\nvar consolelog_1 = require(\"../utils/consolelog\");\nvar drawLines_1 = require(\"./drawLines\");\nexports.drawCanvas = function (ctx, imgBase64) {\n    var img = new Image();\n    img.onload = function (e) {\n        console.log('width', img.naturalWidth, 'height', img.naturalHeight);\n        var width = img.naturalWidth;\n        ;\n        var height = img.naturalHeight;\n        if (width >= height && img.naturalWidth > 320) {\n            consolelog_1.logBlue('width >= height && img.naturalWidth');\n            width = 320;\n            height = (320 / img.naturalWidth) * img.naturalHeight;\n        }\n        ;\n        if (width < height && img.naturalHeight > 320) {\n            consolelog_1.logBlue('width < height && img.naturalWidth');\n            height = 320;\n            width = (320 / img.naturalHeight) * img.naturalWidth;\n        }\n        ;\n        ctx.canvas.width = width;\n        ctx.canvas.height = height;\n        ctx.drawImage(img, 0, 0, width, height);\n    };\n    img.src = imgBase64;\n};\nexports.sketchPics = function (rawCtx, newCtx) {\n    var worker;\n    var width = rawCtx.canvas.width;\n    var height = rawCtx.canvas.height;\n    newCtx.canvas.width = width;\n    newCtx.canvas.height = height;\n    var rawImgData = getPixelsFromCanvas_1.getPixelsFromCanvas(rawCtx);\n    console.log('sketch imgdata', rawImgData);\n    newCtx.clearRect(0, 0, newCtx.canvas.width, newCtx.canvas.height);\n    if (worker) {\n        worker.end();\n    }\n    worker = Worker_1.$worker({\n        \"do\": 'js/img_calc.js',\n        message: function (data) {\n            console.log('get worker message', data.data);\n            var newExe = data.data.exeCom.reverse().map(function (val) { return val.concat([{\n                    action: \"MOVE\", distance: newCtx.canvas.height, direct: \"UP\"\n                }]); }).reduce(function (a, b) { return a.concat(b); });\n            console.log('new exe', newExe);\n            drawLines_1.drawLines(newCtx, newExe);\n        },\n        error: function (err) {\n            consolelog_1.logRed('worker thread error:', err);\n        }\n    });\n    worker.emit({\n        exeFunc: 'transformToGray',\n        infoData: [rawImgData.data, rawImgData.width, [3, 3], [0, 85, 177, 255]]\n    });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/components/domOperate.ts\n// module id = 3\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\n///<reference path=\"d.tss/preLoad.d.ts\"/>\nvar GetDom_1 = require(\"../ts/components/GetDom\");\nvar getPixelsFromCanvas_1 = require(\"./components/getPixelsFromCanvas\");\nvar Events_1 = require(\"./components/Events\");\nvar domOperate_1 = require(\"./components/domOperate\");\n/* css resource */\nrequire('../sass/index.sass');\nrequire('font-awesome/scss/font-awesome.scss');\n/* ----------- */\n/* require from purescript */\n/* ---------- */\n/* ---------------------------import------------------------------------ */\nvar Main = (function () {\n    function Main() {\n    }\n    Main.prototype.run = function () {\n        Events_1.Events.fileInputEve(function (e) {\n            domOperate_1.drawCanvas(GetDom_1.rawContxt, e.target.result);\n        });\n        Events_1.Events.sketchStartEve(GetDom_1.rawContxt, GetDom_1.finalContxt);\n        // let img = new Image();\n        // img.onload = () => {\n        //   this.redrawGrayImg(img, 0, 0, 300, 300)\n        // }\n        // img.src = require('../images/10-dithering-opt.jpg');\n    };\n    ;\n    Main.prototype.redrawGrayImg = function (img, fromX, fromY, width, height) {\n        GetDom_1.rawContxt.drawImage(img, fromX, fromY, width, height);\n        var imageData = getPixelsFromCanvas_1.getPixelsFromCanvas(GetDom_1.rawContxt, fromX, fromY);\n        console.log('img data', imageData);\n        // const worker = $worker({\n        //   do: 'js/img_calc.js',\n        //   message: data => {\n        //     console.log('data', data.data);\n        //     const imgData = rawContxt.createImageData(width, height);\n        //     data.data.UintArray.map((v, i) => {\n        //       imgData.data[i] = v\n        //     })\n        //     // redrawContxt.putImageData(imgData, fromX, fromY)\n        //     console.log('pixePoints', data.data.pixelPoints);\n        //     // drawLines(finalContxt, generateExecutive(data.data.conjArray, 3, width))\n        //   },\n        //   error: err => {\n        //     console.log('err', err)\n        //   }\n        // });\n        // worker.emit({ exeFunc: 'transformToGray', infoData: imageData.data });\n    };\n    return Main;\n}());\nexports.Main = Main;\nvar main = new Main();\nmain.run();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/App.ts\n// module id = 4\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\nvar GetDom_1 = require(\"./GetDom\");\nvar domOperate_1 = require(\"../components/domOperate\");\nvar Events = (function () {\n    function Events() {\n    }\n    Events.fileInputEve = function (callback) {\n        if (callback === void 0) { callback = function (e) {\n            console.log('%cINITIAL FILE ONCHANGE CALLBACK', 'color: blue');\n        }; }\n        var reader = new FileReader();\n        GetDom_1.fileInput.onchange = function (eve) {\n            if (!eve.target.files[0]) {\n                console.warn('SELECTING IMAGE CANCLED');\n                return;\n            }\n            reader.onload = function (e) {\n                callback(e);\n            };\n            reader.readAsDataURL(eve.target.files[0]);\n        };\n        return;\n    };\n    Events.sketchStartEve = function (rawCtx, sketchCtx) {\n        if (sketchCtx === void 0) { sketchCtx = rawCtx; }\n        GetDom_1.sketchBtn.onclick = function (e) {\n            domOperate_1.sketchPics(rawCtx, sketchCtx);\n        };\n    };\n    return Events;\n}());\nexports.Events = Events;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/components/Events.ts\n// module id = 5\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\nvar Worker_ = (function () {\n    function Worker_(option) {\n        this.opt = option;\n        this.setWorker(this.opt[\"do\"]);\n        this._onmessage();\n        this._onerror();\n        return this;\n    }\n    Worker_.prototype.emit = function (data, transfer) {\n        try {\n            this._worker.postMessage(data, transfer);\n        }\n        catch (err) {\n            this.opt.error(err);\n        }\n    };\n    Worker_.prototype.end = function () {\n        this._worker.terminate();\n        return false;\n    };\n    Worker_.prototype._onmessage = function () {\n        this._worker.onmessage = this.opt.message;\n    };\n    Worker_.prototype._onerror = function () {\n        this._worker.onerror = this.opt.error;\n    };\n    Worker_.prototype.setWorker = function (doAct) {\n        this._worker = new Worker(this.getJSBLOB(doAct));\n        return this._worker;\n    };\n    Worker_.prototype.getJSBLOB = function (doAct) {\n        if (typeof doAct === 'string') {\n            return doAct;\n        }\n        var blobJs = new Blob([\"(function BLOB_MODULE(){(\" + doAct.toString() + \")()})()\"], { type: 'text/javascript' });\n        return URL.createObjectURL(blobJs);\n    };\n    return Worker_;\n}());\nexports.Worker_ = Worker_;\nexports.$worker = function (opt) { return new Worker_(opt); };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/utils/Worker.ts\n// module id = 6\n// module chunks = 0","\"use strict\";\nexports.__esModule = true;\nvar DIR_MAP = {\n    'LEFT': [-1, 0],\n    'RIGHT': [1, 0],\n    'UP': [0, -1],\n    'DOWN': [0, 1]\n};\nvar ACTION_MAP = {\n    'DRAW': 'lineTo',\n    'MOVE': 'moveTo'\n};\nexports.drawLines = function (ctx, opts, linStyle, initPosition) {\n    if (linStyle === void 0) { linStyle = {\n        width: .5,\n        color: '#000'\n    }; }\n    if (initPosition === void 0) { initPosition = [.5, .5]; }\n    var timeoutTick;\n    var _point = [initPosition[0], initPosition[1]];\n    console.log('init', _point);\n    ctx.strokeStyle = linStyle.color;\n    ctx.lineWidth = linStyle.width;\n    clearTimeout(timeoutTick);\n    ctx.beginPath();\n    ctx.moveTo(_point[0], _point[1]);\n    var loopExe = function (val, i) {\n        clearTimeout(timeoutTick);\n        _point = [\n            _point[0] + DIR_MAP[val.direct][0] * val.distance,\n            _point[1] + DIR_MAP[val.direct][1] * val.distance\n        ];\n        var command = ACTION_MAP[val.action];\n        var xAxis = _point[0];\n        var yAxis = _point[1];\n        ctx[command](xAxis, yAxis);\n        // logBlue(`${i}:${command},${xAxis},${yAxis}`)\n        ctx.stroke();\n        ctx.closePath();\n    };\n    var timeout = function (i, val) {\n        timeoutTick = setTimeout(function () {\n            loopExe(opts[i], i);\n        }, i * 10);\n    };\n    for (var i in opts) {\n        timeout(Number(i), opts[i]);\n    }\n    return ctx;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/components/drawLines.ts\n// module id = 7\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sass/index.sass\n// module id = 8\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/.4.7.0@font-awesome/scss/font-awesome.scss\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}